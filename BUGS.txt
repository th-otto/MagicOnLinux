640x400x2ip crashes
640x200x2ip crashes
16-colour mode (packed-pixel) works
256-colour mode works
32k-colour mode works
problem with palette?

(23:28:38) DBG-INF LoadReloc() - Memory size Atari = 0x00800000 (= 8192 kBytes)
(23:28:38) DBG-INF LoadReloc() - Load address of system (TEXT) = 0x007c9c68 (68k)


Absturz bei 4 Farben IP:

   exc = bus error (2)
    exception address = 0x21fc125c (?)
    AccessMode = read word
    pc = 0x007cf974 (OS ROM 0x00005d0c)
         code = 0x0028 [0x7214] 0x6100
    sr = 0x2008 (SUP NEG INT=0)
    usp = 0x00080000
     d0 = 0x21fcffff
     d1 = 0x000001bc
     d2 = 0x00000000
     d3 = 0x007c9e78
     d4 = 0x007cb456
     d5 = 0x007cb456
     d6 = 0x007cb456
     d7 = 0x00000000
     a0 = 0x007cb456
     a1 = 0x21fc1234
     a2 = 0x0000e480
     a3 = 0x007cb456
     a4 = 0x0000e4b4
     a5 = 0x007cb456
     a6 = 0x0000e466
     a7 = 0x0000e40a
    ProcPath = C:\AESSYS
    pd = 0x0001db64


Absturz bei 16 Farben IP:

exc = bus error (2)
    exception address = 0x21fc125c (?)
    AccessMode = read word
    pc = 0x007cf974
    sr = 0x2008 (SUP NEG INT=0)
    usp = 0x00080000
     d0 = 0x21fcffff
     d1 = 0x00029c1e
     d2 = 0x007cb456
     d3 = 0x007c9e78
     d4 = 0x007cb456
     d5 = 0x007cb456
     d6 = 0x007cb456
     d7 = 0x00000000
     a0 = 0x00000000
     a1 = 0x21fc1234
     a2 = 0x00029d1a
     a3 = 0x007cb456
     a4 = 0x0000e4b4
     a5 = 0x007cb456
     a6 = 0x0000e466
     a7 = 0x0000e40a
    ProcPath = C:\AESSYS
    pd = 0x0001e204


The Atari memory size is given in bytes and excludes video memory which is handled separately.

Due to a bug in MVDI and NVDI, the VT52 emulator draws graphics artifacts e.g. with CLR SCREEN,
visible in the MagiC task manager or if VT52.PRG is missing, when the screen width and
height are not dividable by the system character size (8x8 or 8x16).

With no VT52.PRG, if starting MCMD, it takes forever until screen gets white,
here nine seconds. Why?

NVDI seems to freeze during start when ASSIGN.SYS is missing?



mcmd shows "0 bytes free"

Keep aspect ratio during window resize?

Emulator should check version of MAGICLIN.OS to make sure the API fits.

What is XHDI, and shall it be supported? It seems that DFS_FAT.S, the MagiC internal (V)FAT12/16/32
file system driver, supports this to get information about a storage volume.

system info control panel shows 29.12.2003 as kernel build date. Update!

Prevent volume image from being mounted twice.

Add command line option to convert Atari text files to UTF-8 and vice-versa, including line endings between CR/LF and LF.

Drag & Drop file systems treats every file as image. If one image is invalid, no further images can be mounted.
Maybe provide a list of supported file names extensions (.st, .image, .diskimage).

Atari/UTF-8 conversion is multiple times in the source code, for filenames and clipboard.


Create disk image:
- 512 bytes per sector
- 2 sectors per cluster
- FAT32
- verbose
- name "FAT32_1M"

dd if=/dev/zero of=vol-fat32-1M.img bs=1M count=1
mkfs.vfat -S 512 -s 2 -F 32 -v -n "FAT32_1M" vol-fat32-1M.img

GEMBENCH crashes (why?) and corrupts the whole emulated system. Why? Is there a deadlock in the emulator?

MGEDIT should be killable via MagiC task manager, but in most time this leads to a total system crash.

The MagiC message "System was overwritten" shall be passed to emulator.

Crash
01:04:39) DBG-ERR AtariGetKeyboardOrMouseData() --- Keine Daten
magic-on-linux: /home/and/Documents/magiclinux/src/HostHandles.cpp:136: void freeHostFD(HostFD*): Assertion `fd->ref_cnt > 0' failed.
Aborted (core dumped)
after copying "Techobox.CAD" to C:\ṪEMP and deleting target
Maybe recursive deleting of directory?


APPLICATIONS

To test:
- TWORD
- CAB
- Highwire
- Prolist (missing GDOS)

Works:

- Chagall v01.00
- Gempaint 1.3B2
- GSTFRAKT (single-app mode)
- MAPS (8+3 case-insensitive drive)
- Papillon 2.2
- Artworx v1.42 (complains about missing GDOS, needs case-insensitive drive)
- Cypress v1.50
- LDW Power Calc 1.03
- Papyrus 4 (complains about missing fonts, needs case-insensitive drive)
- Papyrus 7 (complains about missing fonts)
- Script (complains about missing fonts, needs case-insensitive drive)
- Script 2 (complains about missing fonts, needs case-insensitive drive)
- Technobox CAD/2 (needs case-insensitive drive)
- Texel 2.10
- Pure C
- RCS28K (patched by Andreas Kromke)
- Getinfo v1.1
- Prgflags
- Intrface v2.29beta
- Kobold?
- Olga?
- Pure Pascal: run in single mode (hold Alt key during start)




Works partially:

- CAMCAD (works at least in 640x400 monochrome, should run in single-application mode)
- DR Doodle (corrupts memory blocks, repairable)
- Logo (corrupts memory blocks, repairable)
- Easydraw (complains about missing GDOS)
- Scigraph (complains about missing GDOS)
- Font Expert, FONTEX.PRG (might run in single application mode)
- RSCTEXT (direct video memory acces, might work with 640x400)
- ST-Pascal (direct memory access, then bus error)

Works not:

- CAD 3D
- CAMPUS
- SWFŔAK.PRG (system was overwritten)
- PERSYS (draws artifacts like task manager in B/W)
- PLOT_IT.PRG (draws artifacts like task manager in B/W, then crashes)
- STAD_1_3.PRG (accesses video base register, needs case-insensitive drive, freezes system after crash)
- DBASE (why?)
- PHOENIX 4.2 (strange file selector recursion)     <<<=== needs debugging
- SIGNUM2 (trap #9 or memory mapped access to 68881)
- Wordplus (bus error. Why?)
- Wordplus 2 (bus error)
- SED_440

VDI drivers:

- *.OSD are offscreen drivers and not hardware related
-  *.NOD come from NVDI, they are faster than their OSD pendants.
   They are preferably loaded during boot process if they are found.
- MFA*.SYS are Atari hardware related and not used by MagicOnLinux or predecessors.
- MFM*.SYS are used by MagicOnLinux
-  NFM*.SYS come from NVDI, they are faster than their MFM pendants.
   They are not automatically loaded during boot, as the internal VDI
   explicitly opens e.g. MFM2.SYS in monochrome mode.
   It also seems that they are incompatible.

in particular:

- MFM2.SYS/NFM2.SYS: monochrome mode (black/white)
- MFM4IP.SYS:   4     colours in 2 interleaved planes
- MFM16.SYS:   16     colours in 4 consecutive (?) planes
- MFM16IP.SYS: 16     colours in 4 interlaved planes
- MFM16M.SYS:  16 mio colours, 32-bit pixel packed, 24 from which are used
- MFM32K.SYS:  32768  colours, 16-bit pixel packed
- MFM256.SYS:  256    colours, 8-bit pixel packed

Note that the 16M and 32K graphics formats are direct, i.e. no colour palettes.
All other modes are indirect, with a colour palette.

Note that 16M is recommended for MagicOnLinux. It is similar to the host
graphics format and thus leads to the best performance.
The IP formats are impractical for any kind of software and thus
are really slow.
